{% if documents %}
    <table class="table table-sm align-middle">
      <thead>
          <tr>
              <th class="text-center">Title</th>
              <th class="text-center">Status</th>
              <th class="text-center">Uploaded</th>
              <th class="text-center">Action</th>
              <th class="text-center">Last Indexed</th>
              <th class="text-center">Progress</th>
              <th class="text-center">Model</th>
              <th class="text-center">Chunks</th>
              <th class="text-center">Tokens</th>
          </tr>
      </thead>
      <tbody>
          {% for doc in documents %}
          <tr>
              <td>{{ doc.title }}</td>
              <td class="text-center">
                  {% if doc.status == "ready" %}
                      <span class="badge bg-success">Ready</span>
                  {% elif doc.status == "indexing" %}
                      <span class="badge bg-warning text-dark">Indexing</span>
                  {% elif doc.status == "pending" %}
                      <span class="badge bg-secondary">Pending</span>
                  {% else %}
                      <span class="badge bg-danger">Error</span>
                  {% endif %}
              </td>
              <td class="text-center">{{ doc.created_at.strftime('%Y-%m-%d') }}</td>
              <td class="text-center">
                <button  class="btn btn-danger btn-sm" hx-post="{{ url('document_manager:delete_document', args=[doc.id])}}"
                hx-confirm="Are you sure you want to delete this document ?" hx-trigger="click" {% if doc.status != 'ready' %} disabled {% endif %}
                >Delete</button>
                <button  class="btn btn-outline-secondary btn-sm" hx-post="{{ url('document_manager:reindex_document', args=[doc.id])}}"
                hx-confirm="Re-index document ? this will rebuild embeddings" hx-trigger="click" {% if doc.status != 'ready' %} disabled {% endif %}
                >Re-index</button>
              </td>
              <td class="text-center">
                {% if doc.last_indexed_at %}
                    <small class="text-muted">
                        {{ doc.last_indexed_at.strftime("%m/%d/%Y, %I:%M:%S %p") }}
                    </small>
                {% else %}
                    <small class="text-muted">—</small>
                {% endif %}
              </td>
              <td>
                {% if doc.status == "indexing" %}
                    <div id="progress-{{ doc.id }}" hx-get="{{ url('document_manager:document_progress_panel', args=[doc.id]) }}"
                                hx-trigger="load, every 2s"
                                hx-target="this"
                                hx-swap="innerHTML"
                            >
                            {% if doc.status == "indexing" %}
                                Loading…
                            {% endif %}
                    </div>
                {% else %}
                    <span class="text-success">✔ Done</span>
                {% endif %}
              </td>
              <td class="text-center">{% if doc.embedding_model %} {{ doc.embedding_model }} {% else %} -- {% endif %}</td>
              <td class="text-center">{% if doc.chunk_count %} {{ doc.chunk_count }} {% else %} -- {% endif %}</td>
              <td class="text-center">{% if doc.token_count %} {{ doc.token_count }} {% else %} -- {% endif %}</td>
             
          </tr>
            
          {% endfor %}
      </tbody>
  </table>
{% else %}
  <p class="text-muted">No documents uploaded yet.</p>
{% endif %}